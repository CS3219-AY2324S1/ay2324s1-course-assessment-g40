server {
    listen      8080;
    resolver    127.0.0.11; # docker default DNS server IP address

    location /user {
        # already handles authentication internally

        proxy_pass http://user-service:8001/user/;
    }

    location /api/auth {
        proxy_pass http://user-service:8001/api/auth;
    }

    location /question {
        proxy_pass http://question-service:8002/question/;
    }
    
    location /matching {
        proxy_pass http://matching-service:8003/matching/;
    }

    location / {
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $host;

        proxy_pass http://collab-service:8004/;

        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}